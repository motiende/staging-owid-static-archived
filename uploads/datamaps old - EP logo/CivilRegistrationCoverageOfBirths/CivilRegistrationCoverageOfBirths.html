<!DOCTYPE html>
<meta charset="utf-8">
<link href="../../maxstyle_for_d3/max.nv.d3.css" rel="stylesheet" type="text/css">

<style>


.download { 
  background: #333; 
  color: #FFF; 
  font-weight: 900; 
  border: 2px solid #B10000; 
  padding: 4px; 
  margin:4px;
}

#TitleContainer{
    position: absolute;
	width: 100%;
    height: 26px;
    top:0px;
	left: 0; 
	background-color:#FAFAFA;
}

.mainTitleText{
	font-size:12px;
	font-family:"Helvetica Neue","Helvetica";
}

#CreditsContainer{
    position: absolute;
	width: 100%;
    height: 36px;
    bottom:0px;
	left: 0; 
    background-color:#FAFAFA;

}



#map {
    position: absolute;
    top: 0; bottom: 0; right: 0; left: 0; /*fill parent*/
	background-color:#ECF6FC; /*hellblau*/
}


</style>





<body>
  <script src="d3.v3.min.js"></script>
  <script src="topojson.v1.min.js"></script>
  <!-- I recommend you host this file on your own, since this will change without warning -->
  <script src="datamaps.world.min.js"></script>
  <script src="../../maxstyle_for_d3/colorbrewer.js"></script>

   
<div id="all">
	<div id="map"> </div>
	<div>    <svg id="CreditsContainer"></svg>  </div>
	<div>    <svg id="TitleContainer"></svg>  </div>
</div>

   <script>
     
     
     var colorschemeOfThisMap = colorbrewer.Blues;
  
     var map = new Datamap({
        scope: 'world',
		projection: 'equirectangular',
        element: document.getElementById('map'),
        // projection: 'mercator',

       geographyConfig: {
        borderWidth: 0.2,
        borderColor: '#4F4F4F',
        highlightBorderColor: 'black',
        highlightBorderWidth: 0.5,

        highlightFillColor: '#FFEC38',
        
        popupTemplate: function(geography, data) {
                    if ( !data ) return;  // makes sure that the tooltip is shown only if there is data 
         			return '<div class="hoverinfo">' + geography.properties.name + '<br>Population density: <strong>' +  data.Coverage + '</strong> people per square kilometer';},
            },        
        fills: {
            
              
// Fills & Legendlabels – Reihenfolge ist wichtig - wird in dieser Reihenfolge in der Legende angezeigt (also mit höchstem Wert beginnen)
       defaultFill: '#FFF1E0',
		"above 90": colorschemeOfThisMap[9][8],
		"above 80":colorschemeOfThisMap[9][7],
		"above 70":colorschemeOfThisMap[9][6],
		"above 60":colorschemeOfThisMap[9][5],
		"above 50":colorschemeOfThisMap[9][4],
		"above 40":colorschemeOfThisMap[9][3],
		"above 30":colorschemeOfThisMap[9][2],
		"above 20":colorschemeOfThisMap[9][1],
		"above 10":colorschemeOfThisMap[9][0],
		"below 10":'white',
		"no data": '#FFF1E0'   
		
        },
        
      
  data: {
   "CUB":{Coverage:100,fillKey:"above 90"},
 "PRK":{Coverage:100,fillKey:"above 90"},
 "AUS":{Coverage:90,fillKey:"above 90"},
 "AUT":{Coverage:90,fillKey:"above 90"},
 "BEL":{Coverage:90,fillKey:"above 90"},
 "BGR":{Coverage:90,fillKey:"above 90"},
 "CYP":{Coverage:90,fillKey:"above 90"},
 "CZE":{Coverage:90,fillKey:"above 90"},
 "EST":{Coverage:90,fillKey:"above 90"},
 "DEU":{Coverage:90,fillKey:"above 90"},
 "HUN":{Coverage:90,fillKey:"above 90"},
 "IRL":{Coverage:90,fillKey:"above 90"},
 "ISR":{Coverage:90,fillKey:"above 90"},
 "ITA":{Coverage:90,fillKey:"above 90"},
 "KWT":{Coverage:90,fillKey:"above 90"},
 "LTU":{Coverage:90,fillKey:"above 90"},
 "LUX":{Coverage:90,fillKey:"above 90"},
 "MYS":{Coverage:90,fillKey:"above 90"},
 "MUS":{Coverage:90,fillKey:"above 90"},
 "NLD":{Coverage:90,fillKey:"above 90"},
 "NZL":{Coverage:90,fillKey:"above 90"},
 "PAN":{Coverage:90,fillKey:"above 90"},
 "PHL":{Coverage:90,fillKey:"above 90"},
 "POL":{Coverage:90,fillKey:"above 90"},
 "PRT":{Coverage:90,fillKey:"above 90"},
 "RUS":{Coverage:90,fillKey:"above 90"},
 "VCT":{Coverage:90,fillKey:"above 90"},
 "SYC":{Coverage:90,fillKey:"above 90"},
 "SGP":{Coverage:90,fillKey:"above 90"},
 "SVK":{Coverage:90,fillKey:"above 90"},
 "ESP":{Coverage:90,fillKey:"above 90"},
 "GBR":{Coverage:90,fillKey:"above 90"},
 "VEN":{Coverage:90,fillKey:"above 90"},
 "AND":{Coverage:90,fillKey:"above 90"},
 "ATG":{Coverage:90,fillKey:"above 90"},
 "ARG":{Coverage:90,fillKey:"above 90"},
 "BHR":{Coverage:90,fillKey:"above 90"},
 "BRB":{Coverage:90,fillKey:"above 90"},
 "BLR":{Coverage:90,fillKey:"above 90"},
 "BRN":{Coverage:90,fillKey:"above 90"},
 "CAN":{Coverage:90,fillKey:"above 90"},
 "COK":{Coverage:90,fillKey:"above 90"},
 "CRI":{Coverage:90,fillKey:"above 90"},
 "HRV":{Coverage:90,fillKey:"above 90"},
 "DNK":{Coverage:90,fillKey:"above 90"},
 "DMA":{Coverage:90,fillKey:"above 90"},
 "FJI":{Coverage:90,fillKey:"above 90"},
 "FIN":{Coverage:90,fillKey:"above 90"},
 "FRA":{Coverage:90,fillKey:"above 90"},
 "GRC":{Coverage:90,fillKey:"above 90"},
 "ISL":{Coverage:90,fillKey:"above 90"},
 "IRN":{Coverage:90,fillKey:"above 90"},
 "JPN":{Coverage:90,fillKey:"above 90"},
 "JOR":{Coverage:90,fillKey:"above 90"},
 "LVA":{Coverage:90,fillKey:"above 90"},
 "MLT":{Coverage:90,fillKey:"above 90"},
 "NIU":{Coverage:90,fillKey:"above 90"},
 "NOR":{Coverage:90,fillKey:"above 90"},
 "QAT":{Coverage:90,fillKey:"above 90"},
 "KOR":{Coverage:90,fillKey:"above 90"},
 "MDA":{Coverage:90,fillKey:"above 90"},
 "ROU":{Coverage:90,fillKey:"above 90"},
 "SMR":{Coverage:90,fillKey:"above 90"},
 "SVN":{Coverage:90,fillKey:"above 90"},
 "SWE":{Coverage:90,fillKey:"above 90"},
 "CHE":{Coverage:90,fillKey:"above 90"},
 "TUN":{Coverage:90,fillKey:"above 90"},
 "USA":{Coverage:90,fillKey:"above 90"},
 "URY":{Coverage:90,fillKey:"above 90"},
 "BTN":{Coverage:99.9,fillKey:"above 90"},
 "UZB":{Coverage:99.9,fillKey:"above 90"},
 "UKR":{Coverage:99.8,fillKey:"above 90"},
 "MKD":{Coverage:99.7,fillKey:"above 90"},
 "KAZ":{Coverage:99.7,fillKey:"above 90"},
 "ARM":{Coverage:99.6,fillKey:"above 90"},
 "CHL":{Coverage:99.5,fillKey:"above 90"},
 "BIH":{Coverage:99.5,fillKey:"above 90"},
 "LBN":{Coverage:99.5,fillKey:"above 90"},
 "THA":{Coverage:99.4,fillKey:"above 90"},
 "DZA":{Coverage:99.3,fillKey:"above 90"},
 "EGY":{Coverage:99,fillKey:"above 90"},
 "MNG":{Coverage:99,fillKey:"above 90"},
 "SRB":{Coverage:98.9,fillKey:"above 90"},
 "ALB":{Coverage:98.6,fillKey:"above 90"},
 "SLV":{Coverage:98.6,fillKey:"above 90"},
 "GEO":{Coverage:98.5,fillKey:"above 90"},
 "MNE":{Coverage:97.9,fillKey:"above 90"},
 "JAM":{Coverage:97.8,fillKey:"above 90"},
 "LKA":{Coverage:97.2,fillKey:"above 90"},
 "GTM":{Coverage:96.7,fillKey:"above 90"},
 "SUR":{Coverage:96.6,fillKey:"above 90"},
 "COL":{Coverage:96.5,fillKey:"above 90"},
 "MHL":{Coverage:95.9,fillKey:"above 90"},
 "TTO":{Coverage:95.8,fillKey:"above 90"},
 "TKM":{Coverage:95.5,fillKey:"above 90"},
 "BLZ":{Coverage:95.2,fillKey:"above 90"},
 "SYR":{Coverage:95.2,fillKey:"above 90"},
 "VNM":{Coverage:95,fillKey:"above 90"},
 "IRQ":{Coverage:95,fillKey:"above 90"},
 "KGZ":{Coverage:94.2,fillKey:"above 90"},
 "TUR":{Coverage:93.7,fillKey:"above 90"},
 "AZE":{Coverage:93.6,fillKey:"above 90"},
 "HND":{Coverage:93.5,fillKey:"above 90"},
 "KIR":{Coverage:93.5,fillKey:"above 90"},
 "BRA":{Coverage:93.4,fillKey:"above 90"},
 "PER":{Coverage:92.9,fillKey:"above 90"},
 "MDV":{Coverage:92.5,fillKey:"above 90"},
 "ZAF":{Coverage:91.8,fillKey:"above 90"},
 "CPV":{Coverage:91.4,fillKey:"above 90"},
 "ECU":{Coverage:90,fillKey:"above 90"},
 "BGD":{Coverage:9.8,fillKey:"above 80"},
 "DJI":{Coverage:89.2,fillKey:"above 80"},
 "TJK":{Coverage:88.3,fillKey:"above 80"},
 "GUY":{Coverage:87.9,fillKey:"above 80"},
 "NRU":{Coverage:82.6,fillKey:"above 80"},
 "NIC":{Coverage:81.3,fillKey:"above 80"},
 "COG":{Coverage:81.1,fillKey:"above 80"},
 "HTI":{Coverage:81.1,fillKey:"above 80"},
 "MLI":{Coverage:80.8,fillKey:"above 80"},
 "MDG":{Coverage:79.7,fillKey:"above 70"},
 "DOM":{Coverage:79.2,fillKey:"above 70"},
 "SLE":{Coverage:78,fillKey:"above 70"},
 "TGO":{Coverage:77.9,fillKey:"above 70"},
 "BFA":{Coverage:76.9,fillKey:"above 70"},
 "BOL":{Coverage:75.8,fillKey:"above 70"},
 "BDI":{Coverage:75.2,fillKey:"above 70"},
 "STP":{Coverage:75.1,fillKey:"above 70"},
 "SEN":{Coverage:74.6,fillKey:"above 70"},
 "MMR":{Coverage:72.4,fillKey:"above 70"},
 "BWA":{Coverage:72.2,fillKey:"above 70"},
 "LAO":{Coverage:71.5,fillKey:"above 70"},
 "CMR":{Coverage:70.1,fillKey:"above 70"},
 "NAM":{Coverage:67.1,fillKey:"above 60"},
 "RWA":{Coverage:63.2,fillKey:"above 60"},
 "GHA":{Coverage:62.5,fillKey:"above 60"},
 "KHM":{Coverage:62.1,fillKey:"above 60"},
 "CAF":{Coverage:61,fillKey:"above 60"},
 "BEN":{Coverage:60.3,fillKey:"above 60"},
 "KEN":{Coverage:60,fillKey:"above 60"},
 "SDN":{Coverage:59.3,fillKey:"above 50"},
 "MRT":{Coverage:55.9,fillKey:"above 50"},
 "TLS":{Coverage:55.2,fillKey:"above 50"},
 "CIV":{Coverage:54.9,fillKey:"above 50"},
 "IDN":{Coverage:53.1,fillKey:"above 50"},
 "GMB":{Coverage:52.5,fillKey:"above 50"},
 "TUV":{Coverage:49.9,fillKey:"above 40"},
 "SWZ":{Coverage:49.5,fillKey:"above 40"},
 "ZWE":{Coverage:48.8,fillKey:"above 40"},
 "WSM":{Coverage:47.7,fillKey:"above 40"},
 "LSO":{Coverage:45.1,fillKey:"above 40"},
 "GIN":{Coverage:43.2,fillKey:"above 40"},
 "NPL":{Coverage:42.3,fillKey:"above 40"},
 "IND":{Coverage:41.1,fillKey:"above 40"},
 "AFG":{Coverage:37.4,fillKey:"above 30"},
 "SSD":{Coverage:35.4,fillKey:"above 30"},
 "NER":{Coverage:31.8,fillKey:"above 30"},
 "MOZ":{Coverage:30.8,fillKey:"above 30"},
 "NGA":{Coverage:30,fillKey:"above 30"},
 "UGA":{Coverage:29.9,fillKey:"above 20"},
 "COD":{Coverage:27.8,fillKey:"above 20"},
 "PAK":{Coverage:26.5,fillKey:"above 20"},
 "VUT":{Coverage:25.6,fillKey:"above 20"},
 "GNB":{Coverage:24.1,fillKey:"above 20"},
 "YEM":{Coverage:22.3,fillKey:"above 20"},
 "TZA":{Coverage:16.3,fillKey:"above 10"},
 "TCD":{Coverage:15.7,fillKey:"above 10"},
 "ZMB":{Coverage:14,fillKey:"above 10"},
 "ETH":{Coverage:6.6,fillKey:"below 10"},
 "LBR":{Coverage:3.6,fillKey:"below 10"},
 "SOM":{Coverage:3,fillKey:"below 10"}
  
  
}
});
     
     
     


    
   // Max Plugin
      //plugin added by me to have the legend vertically
  function addLegendmaxstyle(layer, data, options) {
    data = data || {};
    if ( !this.options.fills ) {
      return;
    }

    var html = '<dl>';
    var label = '';
    if ( data.legendTitle ) {
      html = '<h4>' + data.legendTitle + '</h4>' + html;
    }
    
    for ( var fillKey in this.options.fills ) {

      if ( fillKey === 'defaultFill') {
        if (! data.defaultFillName ) {
          continue;
        }
        label = data.defaultFillName;
      } else {
        if (data.labels && data.labels[fillKey]) {
          label = data.labels[fillKey];
        } else {
        
        // Changed by Max //
	label= '' + fillKey;
    html += '<dd style="background-color:' +  this.options.fills[fillKey] + '">&nbsp;</dd>';
	html += '<dt>' + label + '</dt>'+ '<br>';

        }
      }
    }
    html += '</dl>';

    var hoverover = d3.select( this.options.element ).append('div')
      .attr('class', 'datamaps-legend')
      .html(html);
  }
  
  
//Legende anzeigen  
   map.addPlugin("mylegend", addLegendmaxstyle);
   map.mylegend({legendTitle:"Civil Registration Coverage of Births (%)"})

    
    
    







/*  TITLE                      */
/* --------------------------- */

var TitleCanvas = d3.select("#TitleContainer")


TitleCanvas
	.append("text")
	.text("Civil registration coverage of births (in per cent) – latest available data (in 2014)")
	.attr("x",35)
	.attr("y",18)
	.attr('class','mainTitleText');
	
	
	
TitleCanvas.append("svg:image")
   		.attr('x',3)
   		.attr('y',1)
   		.attr('width', 32)
   		.attr('height', 22)
   		.attr("xlink:href","../../maxstyle_for_d3/EPLogo.png");






 
/*--------------------------------------------------*/
/*    				  Credits    					*/
/*--------------------------------------------------*/
   		
var creditsCanvas = d3.select("#CreditsContainer")
		var xorigin=8;
		var yorigin=1;


/*1. Zeile*/	
creditsCanvas
	.append("text")
	.text("The author Max Roser licensed this visualisation under a")
	.attr("x",xorigin+0)
	.attr("y",yorigin+10)
	.attr("id",'erstesTextstuck').attr('class','creditsText');
var erstesTextstuckLange = document.getElementById('erstesTextstuck').getComputedTextLength();

creditsCanvas.append("svg:a")
		  .attr("xlink:href", "http://creativecommons.org/licenses/by-sa/4.0/deed.en_US")
		  .attr("target","_blank")
		  .append("svg:text")
		  .attr("x", xorigin+erstesTextstuckLange+3)
		  .attr("y", yorigin+10)
		  .attr('class','creditsLink').attr("id",'zweitesTextstuck')
	      .text("CC BY-SA license");
var zweitesTextstuckLange = document.getElementById('zweitesTextstuck').getComputedTextLength();


creditsCanvas
	.append("text")
	.text(". You are welcome to share but please refer to its source where you")
	.attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1)
	.attr("y",yorigin+10)
	.attr("id",'drittesTextstuck').attr('class','creditsText');	
var drittesTextstuckLange = document.getElementById('drittesTextstuck').getComputedTextLength();

	
/*1. oder 2. Zeile*/	

var TextViertesTextstuck = creditsCanvas
	.append("text")
	.text("find more information:")
	.attr("id",'viertesTextstuck')
	.attr('class','creditsText');
	var viertesTextstuckLange = document.getElementById('viertesTextstuck').getComputedTextLength();
	
var TextFunftesTextstuck = creditsCanvas.append("svg:a")
		  .attr("xlink:href", "http://www.ourworldindata.org/data/population-growth-vital-statistics/world-population-growth")
		  .attr("target","_blank")
		  .append("svg:text")
		  .attr('class','creditsLink')
	      .text("www.ourworldindata.org/data/population-growth-vital-statistics/world-population-growth")
		  .attr("id",'funftesTextstuck');
var funftesTextstuckLange = document.getElementById('funftesTextstuck').getComputedTextLength();

var creditsCanvasWidth = parseInt(creditsCanvas.style('width'));
var LongTextWidth = parseInt( xorigin + erstesTextstuckLange + 3 + zweitesTextstuckLange + 1 + drittesTextstuckLange + 3 + viertesTextstuckLange + 3 + funftesTextstuckLange );

if (creditsCanvasWidth > LongTextWidth ) {
TextViertesTextstuck
	.attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1+drittesTextstuckLange+3)
	.attr("y",yorigin+10);
	}
 else
  {
TextViertesTextstuck
	.attr("x",xorigin+0)
	.attr("y",yorigin+21);
	  }

	
if (creditsCanvasWidth > LongTextWidth ) {
	TextFunftesTextstuck
		  .attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1+drittesTextstuckLange+3+viertesTextstuckLange+3)
		  .attr("y", yorigin+10);
	}
 else
  {
TextFunftesTextstuck
		  .attr("x", xorigin+102)
		  .attr("y", yorigin+21);
	  }



/*3. Zeile*/	
creditsCanvas
  	.append("text")
  	.text("Data source: World Health Organization (WHO) – Demographic and Socioeconomic Statistics")
  	.attr("x",xorigin+0)
  	.attr("y",yorigin+32)
  	.attr('class','creditsText');
	
	
	
	
/* ------- end credits ------ */
		  

     
     </script>
</body>