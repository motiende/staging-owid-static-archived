<!DOCTYPE html>
<meta charset="utf-8">
<link href="../../maxstyle_for_d3/max.nv.d3.css" rel="stylesheet" type="text/css">

<style>


.download { 
  background: #333; 
  color: #FFF; 
  font-weight: 900; 
  border: 2px solid #B10000; 
  padding: 4px; 
  margin:4px;
}

#TitleContainer{
    position: absolute;
	width: 100%;
    height: 26px;
    top:0px;
	left: 0; 
	background-color:#FAFAFA;
}

.mainTitleText{
	font-size:12px;
	font-family:"Helvetica Neue","Helvetica";
}

#CreditsContainer{
    position: absolute;
	width: 100%;
    height: 36px;
    bottom:0px;
	left: 0; 
    background-color:#FAFAFA;

}



#map {
    position: absolute;
    top: 0; bottom: 0; right: 0; left: 0; /*fill parent*/
	background-color:#ECF6FC; /*hellblau*/
}


</style>





<body>
  <script src="d3.v3.min.js"></script>
  <script src="topojson.v1.min.js"></script>
  <!-- I recommend you host this file on your own, since this will change without warning -->
  <script src="datamaps.world.min.js"></script>
  <script src="../../maxstyle_for_d3/colorbrewer.js"></script>

   
<div id="all">
	<div id="map"> </div>
	<div>    <svg id="CreditsContainer"></svg>  </div>
	<div>    <svg id="TitleContainer"></svg>  </div>
</div>

   <script>
     
     
     var colorschemeOfThisMap = colorbrewer.YlGnBu;
  
     var map = new Datamap({
        scope: 'world',
		projection: 'equirectangular',
        element: document.getElementById('map'),
        // projection: 'mercator',

       geographyConfig: {
        borderWidth: 0.2,
        borderColor: '#4F4F4F',
        highlightBorderColor: 'black',
        highlightBorderWidth: 0.5,

        highlightFillColor: '#FFEC38',
        
        popupTemplate: function(geography, data) {
                    if ( !data ) return;  // makes sure that the tooltip is shown only if there is data 
         			return '<div class="hoverinfo">' + geography.properties.name + '<br>Population density: <strong>' +  data.Density + '</strong> people per square kilometer';},
            },        
        fills: {
            
              
// Fills & Legendlabels – Reihenfolge ist wichtig - wird in dieser Reihenfolge in der Legende angezeigt (also mit höchstem Wert beginnen)
       defaultFill: 'grey',
		"> 500": colorschemeOfThisMap[9][8],
		"200 - 499":colorschemeOfThisMap[9][7],
		"100 - 199":colorschemeOfThisMap[9][6],
		"50 - 99":colorschemeOfThisMap[9][5],
		"10 - 49":colorschemeOfThisMap[9][4],
		"5 - 9.9":colorschemeOfThisMap[9][3],
		"1 - 4.9":colorschemeOfThisMap[9][2],
		"0.2 - 0.9":colorschemeOfThisMap[9][1],
		"< 0.2":colorschemeOfThisMap[9][0],
		"no data": 'grey'   
		
        },
        
      
  data: {
  
"VAT":{Density:1918.81,fillKey:"> 500"},
"KIR":{Density:741.46,fillKey:"> 500"},
"MAC":{Density:718.35,fillKey:"> 500"},
"MLT":{Density:197.35,fillKey:"100 - 199"},
"BRB":{Density:181.48,fillKey:"100 - 199"},
"PSE":{Density:149.85,fillKey:"100 - 199"},
"BGD":{Density:111.44,fillKey:"100 - 199"},
"MCO":{Density:107.51,fillKey:"100 - 199"},
"SYC":{Density:73.73,fillKey:"50 - 99"},
"TUV":{Density:65.79,fillKey:"50 - 99"},
"JPN":{Density:63.37,fillKey:"50 - 99"},
"LIE":{Density:62.57,fillKey:"50 - 99"},
"GIB":{Density:60.00,fillKey:"50 - 99"},
"GRD":{Density:59.78,fillKey:"50 - 99"},
"SMR":{Density:57.36,fillKey:"50 - 99"},
"BEL":{Density:57.34,fillKey:"50 - 99"},
"NLD":{Density:56.61,fillKey:"50 - 99"},
"VCT":{Density:53.16,fillKey:"50 - 99"},
"VIR":{Density:51.98,fillKey:"50 - 99"},
"BMU":{Density:49.53,fillKey:"10 - 49"},
"NRU":{Density:46.56,fillKey:"10 - 49"},
"ITA":{Density:45.27,fillKey:"10 - 49"},
"GLP":{Density:42.14,fillKey:"10 - 49"},
"IND":{Density:41.91,fillKey:"10 - 49"},
"CZE":{Density:41.25,fillKey:"10 - 49"},
"LBN":{Density:40.81,fillKey:"10 - 49"},
"FRA":{Density:40.20,fillKey:"10 - 49"},
"LCA":{Density:40.14,fillKey:"10 - 49"},
"KNA":{Density:39.64,fillKey:"10 - 49"},
"MSR":{Density:38.46,fillKey:"10 - 49"},
"TON":{Density:38.45,fillKey:"10 - 49"},
"MDV":{Density:37.60,fillKey:"10 - 49"},
"DEU":{Density:36.62,fillKey:"10 - 49"},
"KOR":{Density:36.51,fillKey:"10 - 49"},
"GUM":{Density:35.97,fillKey:"10 - 49"},
"IRL":{Density:35.26,fillKey:"10 - 49"},
"CHE":{Density:32.01,fillKey:"10 - 49"},
"BHR":{Density:31.74,fillKey:"10 - 49"},
"BDI":{Density:31.57,fillKey:"10 - 49"},
"RWA":{Density:29.93,fillKey:"10 - 49"},
"GBR":{Density:27.96,fillKey:"10 - 49"},
"TWN":{Density:27.89,fillKey:"10 - 49"},
"BEN":{Density:25.84,fillKey:"10 - 49"},
"WLF":{Density:25.67,fillKey:"10 - 49"},
"AUT":{Density:25.64,fillKey:"10 - 49"},
"LUX":{Density:24.71,fillKey:"10 - 49"},
"SVK":{Density:23.47,fillKey:"10 - 49"},
"LKA":{Density:22.71,fillKey:"10 - 49"},
"COK":{Density:21.81,fillKey:"10 - 49"},
"PRT":{Density:21.56,fillKey:"10 - 49"},
"NPL":{Density:20.77,fillKey:"10 - 49"},
"ATG":{Density:20.07,fillKey:"10 - 49"},
"NGA":{Density:19.80,fillKey:"10 - 49"},
"FSM":{Density:19.48,fillKey:"10 - 49"},
"POL":{Density:19.43,fillKey:"10 - 49"},
"MTQ":{Density:18.94,fillKey:"10 - 49"},
"DNK":{Density:18.86,fillKey:"10 - 49"},
"PRK":{Density:17.73,fillKey:"10 - 49"},
"COM":{Density:17.60,fillKey:"10 - 49"},
"HUN":{Density:16.25,fillKey:"10 - 49"},
"PAK":{Density:15.96,fillKey:"10 - 49"},
"ESP":{Density:15.80,fillKey:"10 - 49"},
"MDA":{Density:15.55,fillKey:"10 - 49"},
"VGB":{Density:14.53,fillKey:"10 - 49"},
"ASM":{Density:13.94,fillKey:"10 - 49"},
"SRB":{Density:13.01,fillKey:"10 - 49"},
"SVN":{Density:12.44,fillKey:"10 - 49"},
"HRV":{Density:11.79,fillKey:"10 - 49"},
"HKG":{Density:11.49,fillKey:"10 - 49"},
"GRC":{Density:11.44,fillKey:"10 - 49"},
"GEO":{Density:11.35,fillKey:"10 - 49"},
"BGR":{Density:11.34,fillKey:"10 - 49"},
"CYP":{Density:11.14,fillKey:"10 - 49"},
"GHA":{Density:11.06,fillKey:"10 - 49"},
"ANT":{Density:11.03,fillKey:"10 - 49"},
"TUR":{Density:10.96,fillKey:"10 - 49"},
"TLS":{Density:10.77,fillKey:"10 - 49"},
"ARM":{Density:10.77,fillKey:"10 - 49"},
"CHN":{Density:10.75,fillKey:"10 - 49"},
"CCK":{Density:10.68,fillKey:"10 - 49"},
"ROU":{Density:10.60,fillKey:"10 - 49"},
"ALB":{Density:10.59,fillKey:"10 - 49"},
"KHM":{Density:10.23,fillKey:"10 - 49"},
"UGA":{Density:9.64,fillKey:"5 - 9.9"},
"TGO":{Density:9.29,fillKey:"5 - 9.9"},
"VNM":{Density:9.17,fillKey:"5 - 9.9"},
"MKD":{Density:8.90,fillKey:"5 - 9.9"},
"CYM":{Density:8.85,fillKey:"5 - 9.9"},
"SPM":{Density:8.58,fillKey:"5 - 9.9"},
"BIH":{Density:8.56,fillKey:"5 - 9.9"},
"AIA":{Density:8.40,fillKey:"5 - 9.9"},
"GNB":{Density:8.31,fillKey:"5 - 9.9"},
"UKR":{Density:7.81,fillKey:"5 - 9.9"},
"SEN":{Density:7.68,fillKey:"5 - 9.9"},
"AZE":{Density:7.56,fillKey:"5 - 9.9"},
"MMR":{Density:7.47,fillKey:"5 - 9.9"},
"MHL":{Density:7.28,fillKey:"5 - 9.9"},
"ISR":{Density:6.83,fillKey:"5 - 9.9"},
"GIN":{Density:6.77,fillKey:"5 - 9.9"},
"SYR":{Density:6.67,fillKey:"5 - 9.9"},
"KWT":{Density:6.62,fillKey:"5 - 9.9"},
"JAM":{Density:6.52,fillKey:"5 - 9.9"},
"NIU":{Density:6.51,fillKey:"5 - 9.9"},
"GTM":{Density:6.43,fillKey:"5 - 9.9"},
"BFA":{Density:5.96,fillKey:"5 - 9.9"},
"STP":{Density:5.75,fillKey:"5 - 9.9"},
"ABW":{Density:5.69,fillKey:"5 - 9.9"},
"SLV":{Density:5.38,fillKey:"5 - 9.9"},
"YEM":{Density:5.37,fillKey:"5 - 9.9"},
"TUN":{Density:5.14,fillKey:"5 - 9.9"},
"PLW":{Density:5.02,fillKey:"5 - 9.9"},
"THA":{Density:4.92,fillKey:"1 - 4.9"},
"IDN":{Density:4.89,fillKey:"1 - 4.9"},
"BLR":{Density:4.69,fillKey:"1 - 4.9"},
"GNQ":{Density:4.69,fillKey:"1 - 4.9"},
"PYF":{Density:4.63,fillKey:"1 - 4.9"},
"EGY":{Density:4.58,fillKey:"1 - 4.9"},
"CPV":{Density:4.43,fillKey:"1 - 4.9"},
"MNE":{Density:4.38,fillKey:"1 - 4.9"},
"MWI":{Density:4.32,fillKey:"1 - 4.9"},
"PHL":{Density:4.14,fillKey:"1 - 4.9"},
"AFG":{Density:3.92,fillKey:"1 - 4.9"},
"CMR":{Density:3.86,fillKey:"1 - 4.9"},
"FJI":{Density:3.84,fillKey:"1 - 4.9"},
"UZB":{Density:3.84,fillKey:"1 - 4.9"},
"SWE":{Density:3.60,fillKey:"1 - 4.9"},
"REU":{Density:3.60,fillKey:"1 - 4.9"},
"KEN":{Density:3.49,fillKey:"1 - 4.9"},
"AND":{Density:3.40,fillKey:"1 - 4.9"},
"MUS":{Density:3.35,fillKey:"1 - 4.9"},
"CXR":{Density:3.28,fillKey:"1 - 4.9"},
"IRN":{Density:3.08,fillKey:"1 - 4.9"},
"TJK":{Density:2.91,fillKey:"1 - 4.9"},
"WSM":{Density:2.91,fillKey:"1 - 4.9"},
"COD":{Density:2.87,fillKey:"1 - 4.9"},
"TZA":{Density:2.82,fillKey:"1 - 4.9"},
"PNG":{Density:2.80,fillKey:"1 - 4.9"},
"DMA":{Density:2.79,fillKey:"1 - 4.9"},
"LSO":{Density:2.64,fillKey:"1 - 4.9"},
"MAR":{Density:2.61,fillKey:"1 - 4.9"},
"LAO":{Density:2.60,fillKey:"1 - 4.9"},
"KGZ":{Density:2.34,fillKey:"1 - 4.9"},
"IRQ":{Density:2.29,fillKey:"1 - 4.9"},
"SGP":{Density:2.24,fillKey:"1 - 4.9"},
"DOM":{Density:2.12,fillKey:"1 - 4.9"},
"ETH":{Density:2.09,fillKey:"1 - 4.9"},
"MEX":{Density:2.06,fillKey:"1 - 4.9"},
"ECU":{Density:2.00,fillKey:"1 - 4.9"},
"LBR":{Density:1.97,fillKey:"1 - 4.9"},
"NOR":{Density:1.94,fillKey:"1 - 4.9"},
"MOZ":{Density:1.92,fillKey:"1 - 4.9"},
"HTI":{Density:1.83,fillKey:"1 - 4.9"},
"SDN":{Density:1.83,fillKey:"1 - 4.9"},
"AGO":{Density:1.81,fillKey:"1 - 4.9"},
"MYS":{Density:1.78,fillKey:"1 - 4.9"},
"LTU":{Density:1.74,fillKey:"1 - 4.9"},
"MDG":{Density:1.68,fillKey:"1 - 4.9"},
"EST":{Density:1.61,fillKey:"1 - 4.9"},
"TCA":{Density:1.51,fillKey:"1 - 4.9"},
"LVA":{Density:1.50,fillKey:"1 - 4.9"},
"CIV":{Density:1.38,fillKey:"1 - 4.9"},
"SOM":{Density:1.38,fillKey:"1 - 4.9"},
"FIN":{Density:1.32,fillKey:"1 - 4.9"},
"COG":{Density:1.27,fillKey:"1 - 4.9"},
"SWZ":{Density:1.20,fillKey:"1 - 4.9"},
"ERI":{Density:1.18,fillKey:"1 - 4.9"},
"PER":{Density:1.16,fillKey:"1 - 4.9"},
"PRI":{Density:1.16,fillKey:"1 - 4.9"},
"MLI":{Density:1.15,fillKey:"1 - 4.9"},
"NCL":{Density:1.14,fillKey:"1 - 4.9"},
"DJI":{Density:1.12,fillKey:"1 - 4.9"},
"ZWE":{Density:1.02,fillKey:"1 - 4.9"},
"SAU":{Density:1.02,fillKey:"1 - 4.9"},
"BRN":{Density:1.00,fillKey:"1 - 4.9"},
"CUB":{Density:0.93,fillKey:"0.2 - 0.9"},
"NER":{Density:0.92,fillKey:"0.2 - 0.9"},
"TCD":{Density:0.87,fillKey:"0.2 - 0.9"},
"OMN":{Density:0.86,fillKey:"0.2 - 0.9"},
"CHL":{Density:0.83,fillKey:"0.2 - 0.9"},
"GAB":{Density:0.82,fillKey:"0.2 - 0.9"},
"HND":{Density:0.80,fillKey:"0.2 - 0.9"},
"JOR":{Density:0.77,fillKey:"0.2 - 0.9"},
"DZA":{Density:0.75,fillKey:"0.2 - 0.9"},
"NZL":{Density:0.74,fillKey:"0.2 - 0.9"},
"BOL":{Density:0.74,fillKey:"0.2 - 0.9"},
"ZAF":{Density:0.71,fillKey:"0.2 - 0.9"},
"COL":{Density:0.70,fillKey:"0.2 - 0.9"},
"ARE":{Density:0.69,fillKey:"0.2 - 0.9"},
"NIC":{Density:0.68,fillKey:"0.2 - 0.9"},
"PAN":{Density:0.66,fillKey:"0.2 - 0.9"},
"RUS":{Density:0.66,fillKey:"0.2 - 0.9"},
"QAT":{Density:0.66,fillKey:"0.2 - 0.9"},
"KAZ":{Density:0.65,fillKey:"0.2 - 0.9"},
"BTN":{Density:0.64,fillKey:"0.2 - 0.9"},
"TKM":{Density:0.64,fillKey:"0.2 - 0.9"},
"SHN":{Density:0.57,fillKey:"0.2 - 0.9"},
"VEN":{Density:0.55,fillKey:"0.2 - 0.9"},
"ISL":{Density:0.54,fillKey:"0.2 - 0.9"},
"PRY":{Density:0.50,fillKey:"0.2 - 0.9"},
"CAF":{Density:0.49,fillKey:"0.2 - 0.9"},
"ZMB":{Density:0.48,fillKey:"0.2 - 0.9"},
"GUY":{Density:0.47,fillKey:"0.2 - 0.9"},
"CRI":{Density:0.44,fillKey:"0.2 - 0.9"},
"BHS":{Density:0.44,fillKey:"0.2 - 0.9"},
"GMB":{Density:0.43,fillKey:"0.2 - 0.9"},
"MNG":{Density:0.39,fillKey:"0.2 - 0.9"},
"BLZ":{Density:0.38,fillKey:"0.2 - 0.9"},
"MRT":{Density:0.33,fillKey:"0.2 - 0.9"},
"LBY":{Density:0.31,fillKey:"0.2 - 0.9"},
"NAM":{Density:0.18,fillKey:"< 0.2"},
"URY":{Density:0.17,fillKey:"< 0.2"},
"BWA":{Density:0.16,fillKey:"< 0.2"},
"BRA":{Density:0.14,fillKey:"< 0.2"},
"FRO":{Density:0.14,fillKey:"< 0.2"},
"SUR":{Density:0.12,fillKey:"< 0.2"},
"SLB":{Density:0.11,fillKey:"< 0.2"},
"ARG":{Density:0.11,fillKey:"< 0.2"},
"SLE":{Density:0.11,fillKey:"< 0.2"},
"USA":{Density:0.10,fillKey:"< 0.2"},
"TTO":{Density:0.09,fillKey:"< 0.2"},
"FLK":{Density:0.07,fillKey:"< 0.2"},
"VUT":{Density:0.04,fillKey:"< 0.2"},
"AUS":{Density:0.03,fillKey:"< 0.2"},
"CAN":{Density:0.02,fillKey:"< 0.2"},
"GUF":{Density:0.02,fillKey:"< 0.2"},
"ESH":{Density:0.00,fillKey:"< 0.2"},
"GRL":{Density:0.00,fillKey:"< 0.2"}
  
}
});
     
     
     


    
   // Max Plugin
      //plugin added by me to have the legend vertically
  function addLegendmaxstyle(layer, data, options) {
    data = data || {};
    if ( !this.options.fills ) {
      return;
    }

    var html = '<dl>';
    var label = '';
    if ( data.legendTitle ) {
      html = '<h4>' + data.legendTitle + '</h4>' + html;
    }
    
    for ( var fillKey in this.options.fills ) {

      if ( fillKey === 'defaultFill') {
        if (! data.defaultFillName ) {
          continue;
        }
        label = data.defaultFillName;
      } else {
        if (data.labels && data.labels[fillKey]) {
          label = data.labels[fillKey];
        } else {
        
        // Changed by Max //
	label= '' + fillKey;
    html += '<dd style="background-color:' +  this.options.fills[fillKey] + '">&nbsp;</dd>';
	html += '<dt>' + label + '</dt>'+ '<br>';

        }
      }
    }
    html += '</dl>';

    var hoverover = d3.select( this.options.element ).append('div')
      .attr('class', 'datamaps-legend')
      .html(html);
  }
  
  
//Legende anzeigen  
   map.addPlugin("mylegend", addLegendmaxstyle);
   map.mylegend({legendTitle:"Population density (People per square kilometer)"})

    
    
    







/*  TITLE                      */
/* --------------------------- */

var TitleCanvas = d3.select("#TitleContainer")


TitleCanvas
	.append("text")
	.text("Population density in 1700")
	.attr("x",35)
	.attr("y",18)
	.attr('class','mainTitleText');
	
	
	
TitleCanvas.append("svg:image")
   		.attr('x',3)
   		.attr('y',1)
   		.attr('width', 32)
   		.attr('height', 22)
   		.attr("xlink:href","../../maxstyle_for_d3/EPLogo.png");






 
/*--------------------------------------------------*/
/*    				  Credits    					*/
/*--------------------------------------------------*/
   		
var creditsCanvas = d3.select("#CreditsContainer")
		var xorigin=8;
		var yorigin=1;


/*1. Zeile*/	
creditsCanvas
	.append("text")
	.text("The author Max Roser licensed this visualisation under a")
	.attr("x",xorigin+0)
	.attr("y",yorigin+10)
	.attr("id",'erstesTextstuck').attr('class','creditsText');
var erstesTextstuckLange = document.getElementById('erstesTextstuck').getComputedTextLength();

creditsCanvas.append("svg:a")
		  .attr("xlink:href", "http://creativecommons.org/licenses/by-sa/4.0/deed.en_US")
		  .attr("target","_blank")
		  .append("svg:text")
		  .attr("x", xorigin+erstesTextstuckLange+3)
		  .attr("y", yorigin+10)
		  .attr('class','creditsLink').attr("id",'zweitesTextstuck')
	      .text("CC BY-SA license");
var zweitesTextstuckLange = document.getElementById('zweitesTextstuck').getComputedTextLength();


creditsCanvas
	.append("text")
	.text(". You are welcome to share but please refer to its source where you")
	.attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1)
	.attr("y",yorigin+10)
	.attr("id",'drittesTextstuck').attr('class','creditsText');	
var drittesTextstuckLange = document.getElementById('drittesTextstuck').getComputedTextLength();

	
/*1. oder 2. Zeile*/	

var TextViertesTextstuck = creditsCanvas
	.append("text")
	.text("find more information:")
	.attr("id",'viertesTextstuck')
	.attr('class','creditsText');
	var viertesTextstuckLange = document.getElementById('viertesTextstuck').getComputedTextLength();
	
var TextFunftesTextstuck = creditsCanvas.append("svg:a")
		  .attr("xlink:href", "http://www.OurWorldinData.org/data/population-growth-vital-statistics/world-population-growth")
		  .attr("target","_blank")
		  .append("svg:text")
		  .attr('class','creditsLink')
	      .text("www.OurWorldinData.org/data/population-growth-vital-statistics/world-population-growth")
		  .attr("id",'funftesTextstuck');
var funftesTextstuckLange = document.getElementById('funftesTextstuck').getComputedTextLength();

var creditsCanvasWidth = parseInt(creditsCanvas.style('width'));
var LongTextWidth = parseInt( xorigin + erstesTextstuckLange + 3 + zweitesTextstuckLange + 1 + drittesTextstuckLange + 3 + viertesTextstuckLange + 3 + funftesTextstuckLange );

if (creditsCanvasWidth > LongTextWidth ) {
TextViertesTextstuck
	.attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1+drittesTextstuckLange+3)
	.attr("y",yorigin+10);
	}
 else
  {
TextViertesTextstuck
	.attr("x",xorigin+0)
	.attr("y",yorigin+21);
	  }

	
if (creditsCanvasWidth > LongTextWidth ) {
	TextFunftesTextstuck
		  .attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1+drittesTextstuckLange+3+viertesTextstuckLange+3)
		  .attr("y", yorigin+10);
	}
 else
  {
TextFunftesTextstuck
		  .attr("x", xorigin+102)
		  .attr("y", yorigin+21);
	  }



/*3. Zeile*/	
creditsCanvas
  	.append("text")
  	.text("Data source: The History Database of the Global Environment (HYDE)")
  	.attr("x",xorigin+0)
  	.attr("y",yorigin+32)
  	.attr('class','creditsText');
	
	
	
	
/* ------- end credits ------ */
		  

     
     </script>
</body>