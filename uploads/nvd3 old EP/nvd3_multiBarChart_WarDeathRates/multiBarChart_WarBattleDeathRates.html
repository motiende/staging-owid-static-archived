<!DOCTYPE html>
<meta charset="utf-8">

<link href="nv.d3.css" rel="stylesheet" type="text/css">
<link href="../../maxstyle_for_d3/max.nv.d3.css" rel="stylesheet" type="text/css">

<style>

body {
  overflow-y:hidden;
  overflow-x:hidden;
  margin:0px 4px 0px 0px; /* new & important */
}


#CreditsContainer{
    position: absolute;

    height: 40px;
	background-color: #FAFAFA;
	width:100%;
	bottom:0;
	margin:0;
	border:0;
	padding:0;
	
}

#chart1, #chart2 {
    position: absolute;
 /* border: 2px solid #FAFAFA; */

}


#chart1 .nv-lineChart circle.nv-point,
#chart2 .nv-lineChart circle.nv-point {

    fill-opacity: 0.9;   /* Only lines: 0 – with markers: 0.9 */
}

#chart1 .nv-lineChart path.nv-line,
#chart2 .nv-lineChart path.nv-line {

    stroke-opacity: 0.6; /* Only lines: 1px – with markers: 0.6px */
    stroke-width: 0.5px; /* Only lines: 1.3px – with markers: 0.5px */
}

.tick line {
  opacity: 0.3;
}




</style>
<body>

    
  <div>
    <svg id="chart1"></svg>
  </div>

  <div>
    <svg id="CreditsContainer"></svg>
  </div>


<script src="d3.v3.js"></script>
<script src="nv.d3.js"></script>

<script>


var xxx = [

 {
    "values" : [
  {
    "x":-7.57366E+11,
    "y":1.89727644
  },
  {
    "x":-7.25809E+11,
    "y":2.245626911
  },
  {
    "x":-6.94252E+11,
    "y":1.808153684
  },
  {
    "x":-6.62695E+11,
    "y":1.796607373
  },
  {
    "x":-6.31138E+11,
    "y":1.769434533
  },
  {
    "x":-5.99581E+11,
    "y":1.752414013
  },
  {
    "x":-5.68024E+11,
    "y":1.806709552
  },
  {
    "x":-5.36467E+11,
    "y":1.763442376
  },
  {
    "x":-5.0491E+11,
    "y":2.465306266
  },
  {
    "x":-4.73354E+11,
    "y":0.894066635
  },
  {
    "x":-4.41797E+11,
    "y":0.863004744
  },
  {
    "x":-4.1024E+11,
    "y":0.867154345
  },
  {
    "x":-3.78683E+11,
    "y":0.843304033
  },
  {
    "x":-3.47126E+11,
    "y":0.817332151
  },
  {
    "x":-3.15569E+11,
    "y":0.670224067
  },
  {
    "x":-2.84012E+11,
    "y":0.840883142
  },
  {
    "x":-2.52455E+11,
    "y":0.826724248
  },
  {
    "x":-2.20898E+11,
    "y":0.218856914
  },
  {
    "x":-1.89341E+11,
    "y":0.283662403
  },
  {
    "x":-1.57785E+11,
    "y":0.280344147
  },
  {
    "x":-1.26228E+11,
    "y":0.284269915
  },
  {
    "x":-94670700000,
    "y":0.282079825
  },
  {
    "x":-63113800000,
    "y":0.269222904
  },
  {
    "x":-31556900000,
    "y":0.262270873
  },
  {
    "x":0,
    "y":0.25693732
  },
  {
    "x":31556900000,
    "y":0.25178175
  },
  {
    "x":63113800000,
    "y":0.269641967
  },
  {
    "x":94670700000,
    "y":0.264391884
  },
  {
    "x":1.26228E+11,
    "y":0.203238555
  },
  {
    "x":1.57785E+11,
    "y":0
  },
  {
    "x":1.89341E+11,
    "y":0
  },
  {
    "x":2.20898E+11,
    "y":0
  },
  {
    "x":2.52455E+11,
    "y":0
  },
  {
    "x":2.84012E+11,
    "y":0
  },
  {
    "x":3.15569E+11,
    "y":0
  },
  {
    "x":3.47126E+11,
    "y":0
  },
  {
    "x":3.78683E+11,
    "y":0
  },
  {
    "x":4.1024E+11,
    "y":0
  },
  {
    "x":4.41797E+11,
    "y":0
  },
  {
    "x":4.73354E+11,
    "y":0
  },
  {
    "x":5.0491E+11,
    "y":0
  },
  {
    "x":5.36467E+11,
    "y":0
  },
  {
    "x":5.68024E+11,
    "y":0
  },
  {
    "x":5.99581E+11,
    "y":0
  },
  {
    "x":6.31138E+11,
    "y":0
  },
  {
    "x":6.62695E+11,
    "y":0
  },
  {
    "x":6.94252E+11,
    "y":0
  },
  {
    "x":7.25809E+11,
    "y":0
  },
  {
    "x":7.57366E+11,
    "y":0
  },
  {
    "x":7.88923E+11,
    "y":0
  },
  {
    "x":8.20479E+11,
    "y":0
  },
  {
    "x":8.52036E+11,
    "y":0
  },
  {
    "x":8.83593E+11,
    "y":0
  },
  {
    "x":9.1515E+11,
    "y":0
  },
  {
    "x":9.46707E+11,
    "y":0
  },
  {
    "x":9.78264E+11,
    "y":0
  },
  {
    "x":1.00982E+12,
    "y":0
  },
  {
    "x":1.04138E+12,
    "y":0
  },
  {
    "x":1.07293E+12,
    "y":0
  },
  {
    "x":1.10449E+12,
    "y":0
  },
  {
    "x":1.13605E+12,
    "y":0
  },
  {
    "x":1.16761E+12,
    "y":0
  }
]	,
	
	
	
    "key" : "Colonial"//Extrastate
}
,{
    "values" : [
  {
    "x":-7.57366E+11,
    "y":0.009508914
  },
  {
    "x":-7.25809E+11,
    "y":0
  },
  {
    "x":-6.94252E+11,
    "y":1.19253927
  },
  {
    "x":-6.62695E+11,
    "y":0.76662069
  },
  {
    "x":-6.31138E+11,
    "y":20.96434682
  },
  {
    "x":-5.99581E+11,
    "y":13.5392221
  },
  {
    "x":-5.68024E+11,
    "y":3.802134219
  },
  {
    "x":-5.36467E+11,
    "y":1.866185748
  },
  {
    "x":-5.0491E+11,
    "y":0.036857228
  },
  {
    "x":-4.73354E+11,
    "y":0
  },
  {
    "x":-4.41797E+11,
    "y":0.188969016
  },
  {
    "x":-4.1024E+11,
    "y":0.001397115
  },
  {
    "x":-3.78683E+11,
    "y":0.06176205
  },
  {
    "x":-3.47126E+11,
    "y":0
  },
  {
    "x":-3.15569E+11,
    "y":0.01692001
  },
  {
    "x":-2.84012E+11,
    "y":0.045218188
  },
  {
    "x":-2.52455E+11,
    "y":0.546151204
  },
  {
    "x":-2.20898E+11,
    "y":0.021398371
  },
  {
    "x":-1.89341E+11,
    "y":0.02607439
  },
  {
    "x":-1.57785E+11,
    "y":2.271229145
  },
  {
    "x":-1.26228E+11,
    "y":2.305270659
  },
  {
    "x":-94670700000,
    "y":2.679210551
  },
  {
    "x":-63113800000,
    "y":5.212929071
  },
  {
    "x":-31556900000,
    "y":4.096917717
  },
  {
    "x":0,
    "y":4.034002619
  },
  {
    "x":31556900000,
    "y":4.004375815
  },
  {
    "x":63113800000,
    "y":6.263203643
  },
  {
    "x":94670700000,
    "y":4.226162142
  },
  {
    "x":1.26228E+11,
    "y":4.865235665
  },
  {
    "x":1.57785E+11,
    "y":0.75644425
  },
  {
    "x":1.89341E+11,
    "y":0.034176401
  },
  {
    "x":2.20898E+11,
    "y":0.040205489
  },
  {
    "x":2.52455E+11,
    "y":0.031636547
  },
  {
    "x":2.84012E+11,
    "y":1.039316261
  },
  {
    "x":3.15569E+11,
    "y":0.804666382
  },
  {
    "x":3.47126E+11,
    "y":2.117999789
  },
  {
    "x":3.78683E+11,
    "y":2.094050488
  },
  {
    "x":4.1024E+11,
    "y":2.066967135
  },
  {
    "x":4.41797E+11,
    "y":1.361131765
  },
  {
    "x":4.73354E+11,
    "y":1.328850642
  },
  {
    "x":5.0491E+11,
    "y":1.313750272
  },
  {
    "x":5.36467E+11,
    "y":1.504345851
  },
  {
    "x":5.68024E+11,
    "y":1.26211153
  },
  {
    "x":5.99581E+11,
    "y":0.008049017
  },
  {
    "x":6.31138E+11,
    "y":0.016914697
  },
  {
    "x":6.62695E+11,
    "y":0.524042861
  },
  {
    "x":6.94252E+11,
    "y":0.000454967
  },
  {
    "x":7.25809E+11,
    "y":0
  },
  {
    "x":7.57366E+11,
    "y":0
  },
  {
    "x":7.88923E+11,
    "y":0.005050661
  },
  {
    "x":8.20479E+11,
    "y":0.002800198
  },
  {
    "x":8.52036E+11,
    "y":0.000423823
  },
  {
    "x":8.83593E+11,
    "y":0.17823362
  },
  {
    "x":9.1515E+11,
    "y":0.513742262
  },
  {
    "x":9.46707E+11,
    "y":0.166457224
  },
  {
    "x":9.78264E+11,
    "y":0.001611825
  },
  {
    "x":1.00982E+12,
    "y":0.004776421
  },
  {
    "x":1.04138E+12,
    "y":0.132321656
  },
  {
    "x":1.07293E+12,
    "y":0
  },
  {
    "x":1.10449E+12,
    "y":0
  },
  {
    "x":1.13605E+12,
    "y":0
  },
  {
    "x":1.16761E+12,
    "y":0
  }
],	
	
    "key" : "Interstate"
}
,{
    "values" : [
  {
    "x":-7.57366E+11,
    "y":10.47869941
  },
  {
    "x":-7.25809E+11,
    "y":14.68954128
  },
  {
    "x":-6.94252E+11,
    "y":16.59741826
  },
  {
    "x":-6.62695E+11,
    "y":15.88964247
  },
  {
    "x":-6.31138E+11,
    "y":0.866307102
  },
  {
    "x":-5.99581E+11,
    "y":0.447752333
  },
  {
    "x":-5.68024E+11,
    "y":0.276143317
  },
  {
    "x":-5.36467E+11,
    "y":0.236245987
  },
  {
    "x":-5.0491E+11,
    "y":0.187971863
  },
  {
    "x":-4.73354E+11,
    "y":0.383611111
  },
  {
    "x":-4.41797E+11,
    "y":0.498191042
  },
  {
    "x":-4.1024E+11,
    "y":0.367406314
  },
  {
    "x":-3.78683E+11,
    "y":0.865285973
  },
  {
    "x":-3.47126E+11,
    "y":1.05359696
  },
  {
    "x":-3.15569E+11,
    "y":0.556014
  },
  {
    "x":-2.84012E+11,
    "y":4.666620851
  },
  {
    "x":-2.52455E+11,
    "y":0.456468433
  },
  {
    "x":-2.20898E+11,
    "y":0.5056888
  },
  {
    "x":-1.89341E+11,
    "y":0.834656246
  },
  {
    "x":-1.57785E+11,
    "y":1.005610344
  },
  {
    "x":-1.26228E+11,
    "y":0.825877982
  },
  {
    "x":-94670700000,
    "y":1.280545533
  },
  {
    "x":-63113800000,
    "y":1.798329942
  },
  {
    "x":-31556900000,
    "y":1.746877773
  },
  {
    "x":0,
    "y":2.009496919
  },
  {
    "x":31556900000,
    "y":4.722553788
  },
  {
    "x":63113800000,
    "y":0.715246006
  },
  {
    "x":94670700000,
    "y":0.667460653
  },
  {
    "x":1.26228E+11,
    "y":0.998847417
  },
  {
    "x":1.57785E+11,
    "y":1.389528766
  },
  {
    "x":1.89341E+11,
    "y":2.549892329
  },
  {
    "x":2.20898E+11,
    "y":1.08422144
  },
  {
    "x":2.52455E+11,
    "y":1.623450684
  },
  {
    "x":2.84012E+11,
    "y":1.900708458
  },
  {
    "x":3.15569E+11,
    "y":0.93966153
  },
  {
    "x":3.47126E+11,
    "y":1.344696221
  },
  {
    "x":3.78683E+11,
    "y":2.704773628
  },
  {
    "x":4.1024E+11,
    "y":1.685175138
  },
  {
    "x":4.41797E+11,
    "y":2.152314596
  },
  {
    "x":4.73354E+11,
    "y":1.50752482
  },
  {
    "x":5.0491E+11,
    "y":1.735624101
  },
  {
    "x":5.36467E+11,
    "y":1.096819335
  },
  {
    "x":5.68024E+11,
    "y":3.182778648
  },
  {
    "x":5.99581E+11,
    "y":1.320956479
  },
  {
    "x":6.31138E+11,
    "y":1.584211697
  },
  {
    "x":6.62695E+11,
    "y":2.3241287
  },
  {
    "x":6.94252E+11,
    "y":1.477952399
  },
  {
    "x":7.25809E+11,
    "y":1.102697391
  },
  {
    "x":7.57366E+11,
    "y":1.512006614
  },
  {
    "x":7.88923E+11,
    "y":1.331267227
  },
  {
    "x":8.20479E+11,
    "y":0.936606135
  },
  {
    "x":8.52036E+11,
    "y":0.628529563
  },
  {
    "x":8.83593E+11,
    "y":0.826953789
  },
  {
    "x":9.1515E+11,
    "y":0.783263195
  },
  {
    "x":9.46707E+11,
    "y":0.720058047
  },
  {
    "x":9.78264E+11,
    "y":0.410128901
  },
  {
    "x":1.00982E+12,
    "y":0.244170625
  },
  {
    "x":1.04138E+12,
    "y":0.15102253
  },
  {
    "x":1.07293E+12,
    "y":0.207250002
  },
  {
    "x":1.10449E+12,
    "y":0.106353997
  },
  {
    "x":1.13605E+12,
    "y":0.148698028
  },
  {
    "x":1.16761E+12,
    "y":0.111687122
  }
]
	
	,	
	
    "key" : "Civil" //Interstate
}
,{
    "values" : [
  {
    "x":-7.57366E+11,
    "y":0.00186044
  },
  {
    "x":-7.25809E+11,
    "y":0
  },
  {
    "x":-6.94252E+11,
    "y":0
  },
  {
    "x":-6.62695E+11,
    "y":0
  },
  {
    "x":-6.31138E+11,
    "y":0
  },
  {
    "x":-5.99581E+11,
    "y":0
  },
  {
    "x":-5.68024E+11,
    "y":0
  },
  {
    "x":-5.36467E+11,
    "y":0
  },
  {
    "x":-5.0491E+11,
    "y":0
  },
  {
    "x":-4.73354E+11,
    "y":0
  },
  {
    "x":-4.41797E+11,
    "y":0
  },
  {
    "x":-4.1024E+11,
    "y":0.001501899
  },
  {
    "x":-3.78683E+11,
    "y":0.005692671
  },
  {
    "x":-3.47126E+11,
    "y":0.000841639
  },
  {
    "x":-3.15569E+11,
    "y":3.844907035
  },
  {
    "x":-2.84012E+11,
    "y":0.07000061
  },
  {
    "x":-2.52455E+11,
    "y":0.895331409
  },
  {
    "x":-2.20898E+11,
    "y":1.987143311
  },
  {
    "x":-1.89341E+11,
    "y":1.649090285
  },
  {
    "x":-1.57785E+11,
    "y":0.251838136
  },
  {
    "x":-1.26228E+11,
    "y":0.249744277
  },
  {
    "x":-94670700000,
    "y":0.244628711
  },
  {
    "x":-63113800000,
    "y":0.236724156
  },
  {
    "x":-31556900000,
    "y":0.273636682
  },
  {
    "x":0,
    "y":0.268071993
  },
  {
    "x":31556900000,
    "y":1.093886042
  },
  {
    "x":63113800000,
    "y":1.078437758
  },
  {
    "x":94670700000,
    "y":1.018911513
  },
  {
    "x":1.26228E+11,
    "y":0.942606403
  },
  {
    "x":1.57785E+11,
    "y":1.624211941
  },
  {
    "x":1.89341E+11,
    "y":0.341233392
  },
  {
    "x":2.20898E+11,
    "y":0.316550109
  },
  {
    "x":2.52455E+11,
    "y":1.090867233
  },
  {
    "x":2.84012E+11,
    "y":0.933723888
  },
  {
    "x":3.15569E+11,
    "y":1.454985165
  },
  {
    "x":3.47126E+11,
    "y":1.333588139
  },
  {
    "x":3.78683E+11,
    "y":1.049368505
  },
  {
    "x":4.1024E+11,
    "y":1.617287269
  },
  {
    "x":4.41797E+11,
    "y":2.101271893
  },
  {
    "x":4.73354E+11,
    "y":2.135331187
  },
  {
    "x":5.0491E+11,
    "y":2.026233939
  },
  {
    "x":5.36467E+11,
    "y":1.573637846
  },
  {
    "x":5.68024E+11,
    "y":0.760633846
  },
  {
    "x":5.99581E+11,
    "y":0.316091204
  },
  {
    "x":6.31138E+11,
    "y":0.214252825
  },
  {
    "x":6.62695E+11,
    "y":0
  },
  {
    "x":6.94252E+11,
    "y":0.368523569
  },
  {
    "x":7.25809E+11,
    "y":0.764958449
  },
  {
    "x":7.57366E+11,
    "y":0.056526253
  },
  {
    "x":7.88923E+11,
    "y":0.008708037
  },
  {
    "x":8.20479E+11,
    "y":0.037021024
  },
  {
    "x":8.52036E+11,
    "y":0.158357239
  },
  {
    "x":8.83593E+11,
    "y":0.666309234
  },
  {
    "x":9.1515E+11,
    "y":0.920436295
  },
  {
    "x":9.46707E+11,
    "y":0.622778487
  },
  {
    "x":9.78264E+11,
    "y":0.85723307
  },
  {
    "x":1.00982E+12,
    "y":0.019567403
  },
  {
    "x":1.04138E+12,
    "y":0.036992813
  },
  {
    "x":1.07293E+12,
    "y":0.074708203
  },
  {
    "x":1.10449E+12,
    "y":0.068912109
  },
  {
    "x":1.13605E+12,
    "y":0.113358738
  },
  {
    "x":1.16761E+12,
    "y":0.139665099
  }
]
	
	,	
	
    "key" : "Civil (with foreign intervention)"//Internationalized Intrastate
}




];


var colors = d3.scale.ordinal()
          .range(["black", "darkblue","#ff7232", "#ffcb00"])
          .domain(d3.range(0,4));
		  
keyColor = function(d, i) {return colors(d.key)};

var chart;
nv.addGraph(function() {
    chart = nv.models.multiBarChart()
    //  .transitionDuration(700)
		.margin({top: 30, right: 20, bottom: 75, left: 60}) 
	.stacked(true)  
      .color(keyColor)
      		.tooltipContent(function(key, x, y, e, graph) {return '<h3>' + key + '</h3>' +
               '<p>' +  y + ' in ' + x + '</p>'			})
    //  .delay(0)
      .rotateLabels(45)
      .groupSpacing(0.1)
      ;

    chart.multibar
      .hideable(true);

    chart.reduceXTicks(true).staggerLabels(false);

	chart.xAxis.tickFormat(function(d) {
	                return d3.time.format('%Y')(new Date(d));
	            });

    chart.yAxis
			.axisLabel('World-wide battle deaths per 100,000 people')
			 .axisLabelDistance(40)
        .tickFormat(d3.format(',.0f'))   ;


    d3.select('#chart1')
        .datum(xxx)
       .transition().duration(1000).call(chart);

    nv.utils.windowResize(chart.update);

    chart.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });

    return chart;
});

	


var logoCanvas = d3.select("#chart1")

logoCanvas.append("svg:image")
   		.attr('x',3)
   		.attr('y',1)
   		.attr('width', 32)
   		.attr('height', 22)
   		.attr("xlink:href","../../maxstyle_for_d3/EPLogo.png");



/*--------------------------------------------------*/
/*    				  Credits    					*/
/*--------------------------------------------------*/
   		
var creditsCanvas = d3.select("#CreditsContainer")
		var xorigin=8;
		var yorigin=1;


/*1. Zeile*/	
creditsCanvas
	.append("text")
	.text("The author Max Roser licensed this visualisation under a")
	.attr("x",xorigin+0)
	.attr("y",yorigin+10)
	.attr("id",'erstesTextstuck').attr('class','creditsText');
var erstesTextstuckLange = document.getElementById('erstesTextstuck').getComputedTextLength();

creditsCanvas.append("svg:a")
		  .attr("xlink:href", "http://creativecommons.org/licenses/by-sa/4.0/deed.en_US")
		  .attr("target","_blank")
		  .append("svg:text")
		  .attr("x", xorigin+erstesTextstuckLange+3)
		  .attr("y", yorigin+10)
		  .attr('class','creditsLink').attr("id",'zweitesTextstuck')
	      .text("CC BY-SA license");
var zweitesTextstuckLange = document.getElementById('zweitesTextstuck').getComputedTextLength();


creditsCanvas
	.append("text")
	.text(". You are welcome to share but please refer to its source where you")
	.attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1)
	.attr("y",yorigin+10)
	.attr("id",'drittesTextstuck').attr('class','creditsText');	
var drittesTextstuckLange = document.getElementById('drittesTextstuck').getComputedTextLength();

	
/*1. oder 2. Zeile*/	

var TextViertesTextstuck = creditsCanvas
	.append("text")
	.text("find more information:")
	.attr("id",'viertesTextstuck')
	.attr('class','creditsText');
	var viertesTextstuckLange = document.getElementById('viertesTextstuck').getComputedTextLength();
	
var TextFunftesTextstuck = creditsCanvas.append("svg:a")
		  .attr("xlink:href", "http://www.explainingprogress.com/data/war-peace/war-and-peace-after-1945/")
		  .attr("target","_blank")
		  .append("svg:text")
		  .attr('class','creditsLink')
	      .text("www.explainingprogress.com/data/war-peace/war-and-peace-after-1945")
		  .attr("id",'funftesTextstuck');
var funftesTextstuckLange = document.getElementById('funftesTextstuck').getComputedTextLength();

var creditsCanvasWidth = parseInt(creditsCanvas.style('width'));
var LongTextWidth = parseInt( xorigin + erstesTextstuckLange + 3 + zweitesTextstuckLange + 1 + drittesTextstuckLange + 3 + viertesTextstuckLange + 3 + funftesTextstuckLange );

if (creditsCanvasWidth > LongTextWidth ) {
TextViertesTextstuck
	.attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1+drittesTextstuckLange+3)
	.attr("y",yorigin+10);
	}
 else
  {
TextViertesTextstuck
	.attr("x",xorigin+0)
	.attr("y",yorigin+21);
	  }

	
if (creditsCanvasWidth > LongTextWidth ) {
	TextFunftesTextstuck
		  .attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1+drittesTextstuckLange+3+viertesTextstuckLange+3)
		  .attr("y", yorigin+10);
	}
 else
  {
TextFunftesTextstuck
		  .attr("x", xorigin+102)
		  .attr("y", yorigin+21);
	  }



/*3. Zeile*/	
creditsCanvas
  	.append("text")
  	.text("Data sources: Human Security Project (PRIO data)")
  	.attr("x",xorigin+0)
  	.attr("y",yorigin+32)
  	.attr('class','creditsText');
	
/* ------- end credits ------ */
		  
		  


</script>
