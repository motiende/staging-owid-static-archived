<!DOCTYPE html>
<meta charset="utf-8">
<link href="../../maxstyle_for_d3/max.nv.d3.css" rel="stylesheet" type="text/css">

<style>


.download { 
  background: #333; 
  color: #FFF; 
  font-weight: 900; 
  border: 2px solid #B10000; 
  padding: 4px; 
  margin:4px;
}

#TitleContainer{
    position: absolute;
	width: 100%;
    height: 26px;
    top:0px;
	left: 0; 
	background-color:#FAFAFA;
}

.mainTitleText{
	font-size:12px;
	font-family:"Helvetica Neue","Helvetica";
}





#CreditsContainer{
    position: absolute;
	width: 100%;
    height: 36px;
    bottom:0px;
	left: 0; 
    background-color:#FAFAFA;

}



#map {
    position: absolute;
    top: 0; bottom: 0; right: 0; left: 0; /*fill parent*/
	background-color:#ECF6FC; /*hellblau*/
}


</style>





<body>
  <script src="d3.v3.min.js"></script>
  <script src="topojson.v1.min.js"></script>
  <!-- I recommend you host this file on your own, since this will change without warning -->
  <script src="datamaps.world.min.js"></script>
  <script src="../../maxstyle_for_d3/colorbrewer.js"></script>

   
<div id="all">
	<div id="map"> </div>
	<div>    <svg id="CreditsContainer"></svg>  </div>
	<div>    <svg id="TitleContainer"></svg>  </div>
</div>

   <script>
     
     
     var colorschemeOfThisMap = colorbrewer.RdYlGn;
  
     var map = new Datamap({
        scope: 'world',
		projection: 'equirectangular',
        element: document.getElementById('map'),
        // projection: 'mercator',

       geographyConfig: {
        borderWidth: 0.2,
        borderColor: '#4F4F4F',
        highlightBorderColor: 'black',
        highlightBorderWidth: 0.5,

        highlightFillColor: '#FFEC38',
        
        popupTemplate: function(geography, data) {
                    if ( !data ) return;  // makes sure that the tooltip is shown only if there is data 
         			return '<div class="hoverinfo">' + geography.properties.name + '<br>Per 1,000 life births <strong>' +  data.Rate + '</strong> children were dying before the age of 5.';},
            },        
        fills: {
            
              
// Fills & Legendlabels – Reihenfolge ist wichtig - wird in dieser Reihenfolge in der Legende angezeigt (also mit höchstem Wert beginnen)
       defaultFill: 'grey',
		"300 - 399": colorschemeOfThisMap[8][0],
		"200 - 299":colorschemeOfThisMap[8][1],
		"100 - 199":colorschemeOfThisMap[8][2],
		"50 - 99":colorschemeOfThisMap[8][3],
		"20 - 49":colorschemeOfThisMap[8][4],
		"10 - 19":colorschemeOfThisMap[8][5],
		"no data": 'grey'   
        },
        
      
  data: {
    "MLI":{Rate:392,fillKey:"300 - 399"},
    "MWI":{Rate:339.3,fillKey:"300 - 399"},
    "SLE":{Rate:329.3,fillKey:"300 - 399"},
    "GIN":{Rate:323.4,fillKey:"300 - 399"},
    "YEM":{Rate:320.6,fillKey:"300 - 399"},
    "NER":{Rate:318.7,fillKey:"300 - 399"},
    "BFA":{Rate:315.9,fillKey:"300 - 399"},
    "AFG":{Rate:306.7,fillKey:"300 - 399"},
    "GMB":{Rate:300.8,fillKey:"300 - 399"},
    "SEN":{Rate:289.3,fillKey:"200 - 299"},
    "NGA":{Rate:283.7,fillKey:"200 - 299"},
    "LBR":{Rate:277.4,fillKey:"200 - 299"},
    "BTN":{Rate:271.3,fillKey:"200 - 299"},
    "NPL":{Rate:268.9,fillKey:"200 - 299"},
    "BEN":{Rate:265.1,fillKey:"200 - 299"},
    "MOZ":{Rate:263.8,fillKey:"200 - 299"},
    "TCD":{Rate:261.9,fillKey:"200 - 299"},
    "MDV":{Rate:258.4,fillKey:"200 - 299"},
    "COD":{Rate:253.6,fillKey:"200 - 299"},
    "HTI":{Rate:246.2,fillKey:"200 - 299"},
    "BDI":{Rate:245,fillKey:"200 - 299"},
    "CIV":{Rate:241.7,fillKey:"200 - 299"},
    "EGY":{Rate:237.3,fillKey:"200 - 299"},
    "ETH":{Rate:237,fillKey:"200 - 299"},
    "DZA":{Rate:235.4,fillKey:"200 - 299"},
    "BOL":{Rate:228,fillKey:"200 - 299"},
    "OMN":{Rate:226.8,fillKey:"200 - 299"},
    "IRN":{Rate:226.1,fillKey:"200 - 299"},
    "COM":{Rate:222.5,fillKey:"200 - 299"},
    "BGD":{Rate:220.6,fillKey:"200 - 299"},
    "TGO":{Rate:219.7,fillKey:"200 - 299"},
    "ERI":{Rate:215,fillKey:"200 - 299"},
    "RWA":{Rate:214.6,fillKey:"200 - 299"},
    "TZA":{Rate:212.1,fillKey:"200 - 299"},
    "IND":{Rate:211.1,fillKey:"200 - 299"},
    "CAF":{Rate:209.7,fillKey:"200 - 299"},
    "CMR":{Rate:209.1,fillKey:"200 - 299"},
    "GHA":{Rate:200.4,fillKey:"200 - 299"},
    "MRT":{Rate:193.5,fillKey:"100 - 199"},
    "MAR":{Rate:187.3,fillKey:"100 - 199"},
    "PAK":{Rate:186.3,fillKey:"100 - 199"},
    "TUR":{Rate:186.2,fillKey:"100 - 199"},
    "UGA":{Rate:181,fillKey:"100 - 199"},
    "ZMB":{Rate:179.3,fillKey:"100 - 199"},
    "CPV":{Rate:178.2,fillKey:"100 - 199"},
    "TUN":{Rate:177.1,fillKey:"100 - 199"},
    "LSO":{Rate:175.3,fillKey:"100 - 199"},
    "GTM":{Rate:173.3,fillKey:"100 - 199"},
    "NIC":{Rate:171.5,fillKey:"100 - 199"},
    "MMR":{Rate:169.9,fillKey:"100 - 199"},
    "SWZ":{Rate:168.7,fillKey:"100 - 199"},
    "IDN":{Rate:165.2,fillKey:"100 - 199"},
    "MDG":{Rate:162.3,fillKey:"100 - 199"},
    "PER":{Rate:161.1,fillKey:"100 - 199"},
    "SLV":{Rate:153.9,fillKey:"100 - 199"},
    "SDN":{Rate:152,fillKey:"100 - 199"},
    "COG":{Rate:150.2,fillKey:"100 - 199"},
    "KEN":{Rate:146.4,fillKey:"100 - 199"},
    "HND":{Rate:145.6,fillKey:"100 - 199"},
    "PNG":{Rate:143.2,fillKey:"100 - 199"},
    "LBY":{Rate:138.9,fillKey:"100 - 199"},
    "KIR":{Rate:138.2,fillKey:"100 - 199"},
    "ECU":{Rate:137.7,fillKey:"100 - 199"},
    "BRA":{Rate:130.9,fillKey:"100 - 199"},
    "DOM":{Rate:120.5,fillKey:"100 - 199"},
    "BWA":{Rate:120,fillKey:"100 - 199"},
    "KGZ":{Rate:119.5,fillKey:"100 - 199"},
    "IRQ":{Rate:113.7,fillKey:"100 - 199"},
    "CHN":{Rate:111,fillKey:"100 - 199"},
    "ZWE":{Rate:110.9,fillKey:"100 - 199"},
    "MEX":{Rate:107.4,fillKey:"100 - 199"},
    "SYR":{Rate:107.2,fillKey:"100 - 199"},
    "VUT":{Rate:107.2,fillKey:"100 - 199"},
    "SLB":{Rate:105.6,fillKey:"100 - 199"},
    "ARE":{Rate:99.7,fillKey:"50 - 99"},
    "THA":{Rate:99.4,fillKey:"50 - 99"},
    "NAM":{Rate:97.4,fillKey:"50 - 99"},
    "COL":{Rate:96.7,fillKey:"50 - 99"},
    "JOR":{Rate:89.3,fillKey:"50 - 99"},
    "MHL":{Rate:86.1,fillKey:"50 - 99"},
    "STP":{Rate:86,fillKey:"50 - 99"},
    "VNM":{Rate:84.4,fillKey:"50 - 99"},
    "PHL":{Rate:83.3,fillKey:"50 - 99"},
    "VCT":{Rate:82.4,fillKey:"50 - 99"},
    "MUS":{Rate:80.2,fillKey:"50 - 99"},
    "CHL":{Rate:80.1,fillKey:"50 - 99"},
    "PRY":{Rate:77,fillKey:"50 - 99"},
    "CRI":{Rate:76.2,fillKey:"50 - 99"},
    "BHR":{Rate:75.4,fillKey:"50 - 99"},
    "GUY":{Rate:74.2,fillKey:"50 - 99"},
    "LCA":{Rate:74,fillKey:"50 - 99"},
    "ARG":{Rate:72.6,fillKey:"50 - 99"},
    "SYC":{Rate:71.7,fillKey:"50 - 99"},
    "LKA":{Rate:71.6,fillKey:"50 - 99"},
    "KWT":{Rate:71.1,fillKey:"50 - 99"},
    "PRT":{Rate:68.8,fillKey:"50 - 99"},
    "PAN":{Rate:66.7,fillKey:"50 - 99"},
    "KNA":{Rate:66.5,fillKey:"50 - 99"},
    "ROU":{Rate:65.9,fillKey:"50 - 99"},
    "DMA":{Rate:63.7,fillKey:"50 - 99"},
    "QAT":{Rate:63.7,fillKey:"50 - 99"},
    "VEN":{Rate:62.6,fillKey:"50 - 99"},
    "LBN":{Rate:58.6,fillKey:"50 - 99"},
    "JAM":{Rate:56.5,fillKey:"50 - 99"},
    "MYS":{Rate:56.1,fillKey:"50 - 99"},
    "FJI":{Rate:55.1,fillKey:"50 - 99"},
    "URY":{Rate:53,fillKey:"50 - 99"},
    "TTO":{Rate:52.1,fillKey:"50 - 99"},
    "KOR":{Rate:51.7,fillKey:"50 - 99"},
    "COK":{Rate:50.8,fillKey:"50 - 99"},
    "TON":{Rate:50.5,fillKey:"50 - 99"},
    "BRB":{Rate:47.9,fillKey:"20 - 49"},
    "RUS":{Rate:44.4,fillKey:"20 - 49"},
    "HUN":{Rate:42.7,fillKey:"20 - 49"},
    "CUB":{Rate:42.6,fillKey:"20 - 49"},
    "BGR":{Rate:38.9,fillKey:"20 - 49"},
    "GRC":{Rate:37.5,fillKey:"20 - 49"},
    "POL":{Rate:36.5,fillKey:"20 - 49"},
    "ITA":{Rate:33.6,fillKey:"20 - 49"},
    "BHS":{Rate:30.7,fillKey:"20 - 49"},
    "ESP":{Rate:29.2,fillKey:"20 - 49"},
    "AUT":{Rate:29.1,fillKey:"20 - 49"},
    "MLT":{Rate:27.4,fillKey:"20 - 49"},
    "SGP":{Rate:27.3,fillKey:"20 - 49"},
    "DEU":{Rate:25.6,fillKey:"20 - 49"},
    "LTU":{Rate:25,fillKey:"20 - 49"},
    "BEL":{Rate:24,fillKey:"20 - 49"},
    "USA":{Rate:23.3,fillKey:"20 - 49"},
    "LUX":{Rate:22.3,fillKey:"20 - 49"},
    "IRL":{Rate:22.2,fillKey:"20 - 49"},
    "CAN":{Rate:22,fillKey:"20 - 49"},
    "AUS":{Rate:21.4,fillKey:"20 - 49"},
    "GBR":{Rate:21,fillKey:"20 - 49"},
    "NZL":{Rate:20.8,fillKey:"20 - 49"},
    "CHE":{Rate:18.4,fillKey:"10 - 19"},
    "FRA":{Rate:18.3,fillKey:"10 - 19"},
    "JPN":{Rate:17.5,fillKey:"10 - 19"},
    "DNK":{Rate:16.6,fillKey:"10 - 19"},
    "NOR":{Rate:16.2,fillKey:"10 - 19"},
    "FIN":{Rate:16.1,fillKey:"10 - 19"},
    "ISL":{Rate:15.8,fillKey:"10 - 19"},
    "NLD":{Rate:15.8,fillKey:"10 - 19"},
    "SWE":{Rate:13.4,fillKey:"10 - 19"}
  
}
});
     
     
     


    
   // Max Plugin
      //plugin added by me to have the legend vertically
  function addLegendmaxstyle(layer, data, options) {
    data = data || {};
    if ( !this.options.fills ) {
      return;
    }

    var html = '<dl>';
    var label = '';
    if ( data.legendTitle ) {
      html = '<h4>' + data.legendTitle + '</h4>' + html;
    }
    
    for ( var fillKey in this.options.fills ) {

      if ( fillKey === 'defaultFill') {
        if (! data.defaultFillName ) {
          continue;
        }
        label = data.defaultFillName;
      } else {
        if (data.labels && data.labels[fillKey]) {
          label = data.labels[fillKey];
        } else {
        
        // Changed by Max //
	label= '' + fillKey;
    html += '<dd style="background-color:' +  this.options.fills[fillKey] + '">&nbsp;</dd>';
	html += '<dt>' + label + '</dt>'+ '<br>';

        }
      }
    }
    html += '</dl>';

    var hoverover = d3.select( this.options.element ).append('div')
      .attr('class', 'datamaps-legend')
      .html(html);
  }
  
  
//Legende anzeigen  
   map.addPlugin("mylegend", addLegendmaxstyle);
   map.mylegend({legendTitle:"Child mortality (per 1,000 live births)"})

    
    
    







/*  TITLE                      */
/* --------------------------- */

var TitleCanvas = d3.select("#TitleContainer")


TitleCanvas
	.append("text")
	.text("Children dying before the age of 5 (per 1,000 live births) – in 1970")
	.attr("x",35)
	.attr("y",18)
	.attr('class','mainTitleText');
	
	
	
TitleCanvas.append("svg:image")
   		.attr('x',3)
   		.attr('y',1)
   		.attr('width', 32)
   		.attr('height', 22)
   		.attr("xlink:href","../../maxstyle_for_d3/EPLogo.png");






 
/*--------------------------------------------------*/
/*    				  Credits    					*/
/*--------------------------------------------------*/
   		
var creditsCanvas = d3.select("#CreditsContainer")
		var xorigin=8;
		var yorigin=1;


/*1. Zeile*/	
creditsCanvas
	.append("text")
	.text("The author Max Roser licensed this visualisation under a")
	.attr("x",xorigin+0)
	.attr("y",yorigin+10)
	.attr("id",'erstesTextstuck').attr('class','creditsText');
var erstesTextstuckLange = document.getElementById('erstesTextstuck').getComputedTextLength();

creditsCanvas.append("svg:a")
		  .attr("xlink:href", "http://creativecommons.org/licenses/by-sa/4.0/deed.en_US")
		  .attr("target","_blank")
		  .append("svg:text")
		  .attr("x", xorigin+erstesTextstuckLange+3)
		  .attr("y", yorigin+10)
		  .attr('class','creditsLink').attr("id",'zweitesTextstuck')
	      .text("CC BY-SA license");
var zweitesTextstuckLange = document.getElementById('zweitesTextstuck').getComputedTextLength();


creditsCanvas
	.append("text")
	.text(". You are welcome to share but please refer to its source where you")
	.attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1)
	.attr("y",yorigin+10)
	.attr("id",'drittesTextstuck').attr('class','creditsText');	
var drittesTextstuckLange = document.getElementById('drittesTextstuck').getComputedTextLength();

	
/*1. oder 2. Zeile*/	

var TextViertesTextstuck = creditsCanvas
	.append("text")
	.text("find more information:")
	.attr("id",'viertesTextstuck')
	.attr('class','creditsText');
	var viertesTextstuckLange = document.getElementById('viertesTextstuck').getComputedTextLength();
	
var TextFunftesTextstuck = creditsCanvas.append("svg:a")
		  .attr("xlink:href", "http://www.explainingprogress.com/data/population-growth-vital-statistics/child-mortality")
		  .attr("target","_blank")
		  .append("svg:text")
		  .attr('class','creditsLink')
	      .text("www.explainingprogress.com/data/population-growth-vital-statistics/child-mortality")
		  .attr("id",'funftesTextstuck');
var funftesTextstuckLange = document.getElementById('funftesTextstuck').getComputedTextLength();

var creditsCanvasWidth = parseInt(creditsCanvas.style('width'));
var LongTextWidth = parseInt( xorigin + erstesTextstuckLange + 3 + zweitesTextstuckLange + 1 + drittesTextstuckLange + 3 + viertesTextstuckLange + 3 + funftesTextstuckLange );

if (creditsCanvasWidth > LongTextWidth ) {
TextViertesTextstuck
	.attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1+drittesTextstuckLange+3)
	.attr("y",yorigin+10);
	}
 else
  {
TextViertesTextstuck
	.attr("x",xorigin+0)
	.attr("y",yorigin+21);
	  }

	
if (creditsCanvasWidth > LongTextWidth ) {
	TextFunftesTextstuck
		  .attr("x",xorigin+erstesTextstuckLange+3+zweitesTextstuckLange+1+drittesTextstuckLange+3+viertesTextstuckLange+3)
		  .attr("y", yorigin+10);
	}
 else
  {
TextFunftesTextstuck
		  .attr("x", xorigin+102)
		  .attr("y", yorigin+21);
	  }



/*3. Zeile*/	
creditsCanvas
  	.append("text")
  	.text("Data source: UNICEF's www.childmortality.org")
  	.attr("x",xorigin+0)
  	.attr("y",yorigin+32)
  	.attr('class','creditsText');
	
	
	
	
/* ------- end credits ------ */
		  

     
     </script>
</body>